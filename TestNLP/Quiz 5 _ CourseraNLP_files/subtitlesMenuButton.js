define("bundles/videojs/plugins/subtitlesMenuButton",["require","exports","module","jquery","underscore","videojs","bundles/videojs/layout/controls.html","bundles/videojs/plugins/subtitlesOffMenuItem","bundles/videojs/plugins/subtitlesMenu","bundles/videojs/plugins/subtitlesMenuItem"],function(require,exports,module){"use strict";function _defaults(e,r){for(var i=Object.getOwnPropertyNames(r),t=0;t<i.length;t++){var n=i[t],o=Object.getOwnPropertyDescriptor(r,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var i=function(){function defineProperties(o,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),c=function get(i,l,a){var n=!0;e:for(;n;){var t=i,u=l,s=a;n=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,u);if(void 0===e){var o=Object.getPrototypeOf(t);if(null===o)return void 0;i=o,l=u,a=s,n=!0,e=o=void 0;continue e}if("value"in e)return e.value;var r=e.get;if(void 0===r)return void 0;return r.call(s)}},$=require("jquery"),_=require("underscore"),t=require("videojs"),n=require("bundles/videojs/layout/controls.html");require("bundles/videojs/plugins/subtitlesOffMenuItem"),require("bundles/videojs/plugins/subtitlesMenu"),require("bundles/videojs/plugins/subtitlesMenuItem");var o=38,u=40,r=9,s=13,l=32,a=27,e="vjs-highlighted",f=function handleUpAndDownArrowKeys(i,o){var t=_(i.children_).filter(function(e){return!e.hasClass("vjs-hidden")}),r=_(t).find(function(t){return t.hasClass(e)}),n=-1;r&&(n=_(t).chain().map(function(e){return e.el_}).indexOf(r.el_).value(),-1!==n&&t[n].removeClass(e)),0>=n&&-1===o?t[t.length-1].addClass(e):(0>n||n>=t.length-1)&&1===o?t[0].addClass(e):t[n+o].addClass(e)},d=function handleTabAndEscapeKeys(t){t.unlockShowing(),_(t.children_).each(function(t){t.removeClass(e)})},h=function handleEnterAndSpaceKeys(t){var o=_(t.children_).filter(function(e){return!e.hasClass("vjs-hidden")}),n=_(o).find(function(t){return t.hasClass(e)});n&&n.handleClick(),t.lockShowing()},v=function(v){function SubtitlesMenuButton(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];_classCallCheck(this,SubtitlesMenuButton),c(Object.getPrototypeOf(SubtitlesMenuButton.prototype),"constructor",this).call(this,e,t);var n=t.defaultSubtitleLanguage;n?this.menu.showSubtitleOffItem():this.menu.hideSubtitleOffItem(),this.one(e,"ready",function(){_(e.textTracks()).forEach(function(e){e.language===n?e.mode="showing":e.mode="hidden"})})}return _inherits(SubtitlesMenuButton,v),i(SubtitlesMenuButton,[{key:"createEl",value:function createEl(o,r){var t=$(n({controlName:"subtitlesMenuButton"}));return this.contentEl_=t.find(".vjs-control-content").get(0),t.on("focus",function(){var t=this.player_.controlBar.subtitlesMenuButton.menu;_(t.children_).last().addClass(e),t.lockShowing()}.bind(this)),t.get(0)}},{key:"onKeyPress",value:function onKeyPress(e){var t=$(this.player_.controlBar.subtitlesMenuButton.contentEl_),n=this.player_.controlBar.subtitlesMenuButton.menu;e.keyCode===o||e.keyCode===u?(f(n,e.keyCode===o?-1:1),t.focus(),e.preventDefault(),e.stopPropagation()):e.keyCode===r||e.keyCode===a?(d(n),t.blur()):(e.keyCode===s||e.keyCode===l)&&(h(n),t.focus(),e.preventDefault(),e.stopPropagation())}},{key:"handleClick",value:function handleClick(r){this.player_.controlBar.subtitlesMenuButton.menu.unlockShowing();var e=this.player_.textTracks(),t=_(e).findWhere({mode:"showing"});if(t)t.mode="disabled";else if(e.length){var n=_(e).findWhere({"default":!0});if(n)n.mode="showing";else{var o=_(e).findWhere({language:"en"});o?o.mode="showing":e[0].mode="showing"}}}},{key:"createMenu",value:function createMenu(){var r=t.getComponent("SubtitlesMenu"),e=new r(this.player_,this.options_.subtitlesMenu);this.items=this.createItems(),this.items.forEach(function(t){return e.addItem(t)});var o=e.contentEl().children[0]||null;return e.contentEl().insertBefore($(n({controlName:"subtitlesMenuTitle"}))[0],o),e.contentEl().insertBefore($(n({controlName:"menuDivider"}))[0],o),e}},{key:"createItems",value:function createItems(){var n=t.getComponent("SubtitlesOffMenuItem"),e=new n(this.player_,{kind:"subtitles",id:"subtitles-off"});e.hide();var o=t.getComponent("SubtitlesMenuItem");return[e].concat(_.chain(this.player_.textTracks()).filter(function(e){return"subtitles"===e.kind}).map(function(e){return new o(this.player_,{track:e,selectable:!0})},this).value())}}]),SubtitlesMenuButton}(t.getComponent("SubtitlesButton"));t.registerComponent("SubtitlesMenuButton",v)});