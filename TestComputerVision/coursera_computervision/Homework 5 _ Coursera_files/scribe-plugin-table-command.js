define("bundles/vendor/scribe-plugins/scribe-plugin-table-command",[],function(){return function(n){function __webpack_require__(t){if(e[t])return e[t].exports;var module=e[t]={exports:{},id:t,loaded:!1};return n[t].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var e={};return __webpack_require__.m=n,__webpack_require__.c=e,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,n){var t=n(1),e=n(6);module.exports=function(){return function(n){function findBlockContainer(e){for(;e&&!n.element.isBlockElement(e);)e=e.parentNode;return e}function handleKeydown(l){if(13===l.keyCode){var o=new n.api.Selection,t=o.range,a=t.endContainer,r=e.findTable(n,a),c=e.findTableCell(n,a),d=Array.prototype.indexOf.call(n.el.childNodes,r)+1,i=null;c&&(l.preventDefault(),i=document.createElement("p"),r.nextSibling?n.el.insertBefore(i,r.nextSibling):n.el.appendChild(i),t.setStart(n.el.childNodes[d],0),t.collapse(!0),o.selection.removeAllRanges(),o.selection.addRange(t))}}function handleRightClick(t){var o=t.target||t.toElement;if(!o)return;var i=e.findTableCell(n,o),l=e.findTable(n,i);l&&(t.preventDefault(),t.stopPropagation(),r.show(l,i))}var o=new n.api.Command("insertTable"),r=new t(n);o.nodeName="TABLE",o.execute=function(){var t=e.createTable(3,3);n.transactionManager.run(function(){var r=new n.api.Selection,i=findBlockContainer(r.range.endContainer),o=i.nextSibling;o?n.el.insertBefore(t,o):n.el.appendChild(t);var l=t.childNodes[0],a=l.childNodes[0],c=a.childNodes[0];e.select(n,c)})},o.queryState=function(){var e=new n.api.Selection;return e.getContaining(function(e){return e.nodeName===this.nodeName}.bind(this))},o.queryEnabled=function(){return!0},n.el.addEventListener("keydown",handleKeydown),n.el.addEventListener("contextmenu",handleRightClick),n.commands.table=o}}},function(module,exports,n){n(2);var e=n(6),o=[{id:0,text:"Insert row above"},{id:1,text:"Insert row below"},{id:2,text:"Insert column left"},{id:3,text:"Insert column right"},{id:4,text:"Delete row"},{id:5,text:"Delete column"},{id:6,text:"Delete table"}],t="scribe-table-context-menu",r="scribe-table-context-menu-action",i=function(e){for(var n=0,t=0;e;)n+=e.offsetTop,t+=e.offsetLeft,e!==document.body&&(n-=e.scrollTop),e=e.offsetParent;return{top:n,left:t}},l=function(n){return this.show=function(a,n){this.hide();var e=document.createElement("div"),l=i(n);e.className=t,e.style.top=l.top+20+"px",e.style.left=l.left+20+"px",o.forEach(function(o){var t=document.createElement("div");t.className=r,t.textContent=o.text,t.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),this.handleAction(a,n,o)}.bind(this)),e.appendChild(t)}.bind(this)),document.body.appendChild(e),document.addEventListener("click",function(e){3!==e.which&&this.hide()}.bind(this))},this.hide=function(){var e=document.getElementsByClassName(t)[0];e&&e.parentNode.removeChild(e),document.removeEventListener("click",this.hide)},this.handleAction=function(t,r,i){var o=e.findCellPosition(t,r);switch(this.hide(),i.id){case 0:e.insertRow(n,t,o.rowIndex);break;case 1:e.insertRow(n,t,o.rowIndex+1);break;case 2:e.insertColumn(n,t,o.columnIndex);break;case 3:e.insertColumn(n,t,o.columnIndex+1);break;case 4:e.removeRow(n,t,o.rowIndex);break;case 5:e.removeColumn(n,t,o.columnIndex);break;case 6:e.removeTable(n,t)}},this};module.exports=l},function(module,exports){},,,,function(module,exports){var e={createTableCell:function(){var e=document.createElement("td");return e},createTableRow:function(o){for(var n=document.createElement("tr"),t=0;o>t;t++)n.appendChild(e.createTableCell());return n},createTable:function(r,i){for(var n=document.createElement("table"),t=document.createElement("tbody"),o=0;r>o;o++)t.appendChild(e.createTableRow(i));return n.appendChild(t),n},getColumnCount:function(e){var n=e.childNodes[0],t=n.childNodes;return t[0].childNodes.length},getRowCount:function(e){var n=e.childNodes[0];return n.childNodes.length},findTable:function(n,e){for(;e&&e!==n.el&&"TABLE"!==e.nodeName;)e=e.parentNode;return e&&"TABLE"!==e.nodeName&&(e=null),e},findTableCell:function(n,e){for(;e&&e!==n.el&&"TD"!==e.nodeName;)e=e.parentNode;return e&&"TD"!==e.nodeName&&(e=null),e},findCellPosition:function(n,t){var o=n.childNodes[0],r=Array.prototype.slice.call(o.childNodes),e={rowIndex:-1,columnIndex:-1};return r.every(function(n,o){var r=Array.prototype.slice.call(n.childNodes);if(r.every(function(n,r){if(n===t)return e={rowIndex:o,columnIndex:r},!1;return!0}),-1!==e.rowIndex)return!1;return!0}),e},insertRow:function(n,t,i){var l=e.getColumnCount(t),o=t.childNodes[0],a=o.childNodes[i],r=e.createTableRow(l);n.transactionManager.run(function(){o.insertBefore(r,a),this.select(n,r.childNodes[0])}.bind(this))},removeRow:function(o,n,t){if(1===this.getRowCount(n))return void this.removeTable(o,n);var r=n.childNodes[0],i=r.childNodes[t];o.transactionManager.run(function(){r.removeChild(i),t>=e.getRowCount(n)&&t--,this.select(o,r.childNodes[t].childNodes[0])}.bind(this))},insertColumn:function(n,r,t){var o=r.childNodes[0],i=Array.prototype.slice.call(o.childNodes);n.transactionManager.run(function(){i.forEach(function(n){var o=e.createTableCell();n.insertBefore(o,n.childNodes[t])}),this.select(n,o.childNodes[0].childNodes[t])}.bind(this))},removeColumn:function(e,n,o){var r=this.getColumnCount(n),t=n.childNodes[0],i=Array.prototype.slice.call(t.childNodes);if(1===r)return void this.removeTable(e,n);e.transactionManager.run(function(){i.forEach(function(e){e.removeChild(e.childNodes[o])}),this.select(e,t.childNodes[0].childNodes[0])}.bind(this))},removeTable:function(e,n){e.transactionManager.run(function(){e.el.removeChild(n),this.select(e,e.el.childNodes[0])}.bind(this))},select:function(n,t){var e=new n.api.Selection;e.range.setStart(t,0),e.range.collapse(!0),e.selection.removeAllRanges(),e.selection.addRange(e.range)}};module.exports=e}])});