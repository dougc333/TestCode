define("bundles/assess/questionTypes/pollBase/student/view",["require","exports","module","underscore","bundles/assess/questionTypes/optionBase/student/view","bundles/assess/questionTypes/pollBase/student/feedbackTemplate.html","bundles/assess/questionTypes/pollBase/student/headerTemplate.html","bundles/assess/questionTypes/pollBase/student/optionTemplate.html","bundles/phoenix/lib/renderContent","js/lib/util"],function(require,exports,module){"use strict";var _=require("underscore"),e=require("bundles/assess/questionTypes/optionBase/student/view"),t=require("bundles/assess/questionTypes/pollBase/student/feedbackTemplate.html"),n=require("bundles/assess/questionTypes/pollBase/student/headerTemplate.html"),o=require("bundles/assess/questionTypes/pollBase/student/optionTemplate.html"),s=require("bundles/phoenix/lib/renderContent"),i=require("js/lib/util"),a=e.extend({feedbackTemplate:t,headerTemplate:n,optionTemplate:o,className:e.prototype.className+" coursera-assess-question-pollBase",supportedStyles:["coursera-assess-style-question-in-video","coursera-assess-style-question-default","coursera-assess-style-question-quick","coursera-assess-style-question-survey"],initialize:function initialize(e){this.options=this.options||e||{}},isIdChosen:function isIdChosen(e,s){return!1},getTotalNumberResponses:function getTotalNumberResponses(){return 0},isAChosenOptionZero:function isAChosenOptionZero(e,s){return!1},renderHistogram:function renderHistogram(a,t,s){var r=this,e=this.getTotalNumberResponses(),n=this.isAChosenOptionZero(s,t);n&&(e+=1);var u=_(a).map(function(e){var o=_(t).find(function(s){return e.id===s.id})||{id:e.id,count:0};return n&&r.isIdChosen(s,o.id)&&(o.count+=1),_({}).extend(e,{count:o.count})}),o=_(u).map(function(s){var t=s.count/e;return _({}).extend(s,{fraction:t})});this.$el.html(this.feedbackTemplate({options:o,totalNumResponses:e,totalNumResponsesPretty:i.addCommas(e.toString()),myResponseChosenId:s,isIdChosen:this.isIdChosen,headerTemplate:this.headerTemplate})),this.renderHistogramReactViews(o)},renderHistogramReactViews:function renderHistogramReactViews(e){var t=this,n=this.options.instance;s(n.variant.definition.prompt,this.$$("prompt")),e.forEach(function(e){var n=t.$('[data-option-id="'+e.id+'"]');s(e.display,n.find('[data-js~="option-display"]'))})},render:function render(){var t=this.options.instance,s=t.variant.definition;if(s.histogram)this.renderHistogram(s.options,s.histogram,s.previousResponse);else if(t.feedback){var n=t.feedback.definition,o=t.effectiveResponse.response;this.renderHistogram(s.options,n.options,o.chosen)}else e.prototype.render.call(this)}});module.exports=a});