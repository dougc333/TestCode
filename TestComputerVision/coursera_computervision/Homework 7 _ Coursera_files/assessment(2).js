define("pages/open-course/assessment/models/openSinglePage/assessment",["require","exports","module","backbone-associations","underscore","pages/open-course/assessment/models/openSinglePage/evaluation","pages/open-course/assessment/models/relativePassingStates","pages/open-course/common/constants","pages/open-course/common/data/openSinglePage/assessmentData"],function(require,exports,module){"use strict";var Backbone=require("backbone-associations"),_=require("underscore"),e=require("pages/open-course/assessment/models/openSinglePage/evaluation"),t=require("pages/open-course/assessment/models/relativePassingStates"),s=require("pages/open-course/common/constants"),n=require("pages/open-course/common/data/openSinglePage/assessmentData"),a=Backbone.AssociatedModel.extend({defaults:{metadata:null},relations:[{type:Backbone.Associations.One,key:"evaluation",relatedModel:e},{type:Backbone.Associations.One,key:"lastEvaluation",relatedModel:e},{type:Backbone.Associations.One,key:"bestEvaluation",relatedModel:e}],initialize:function initialize(e){if(!e||!e.metadata)throw new Error("metadata is required to instantiate this model");this.set("metadata",e.metadata)},hasUnsubmittedAttempt:function hasUnsubmittedAttempt(){return null!==this.get("unsubmittedAttemptIndex")},hasSubmittedAttempt:function hasSubmittedAttempt(){return null!==this.get("lastSubmittedAttemptIndex")},getQuestionCount:function getQuestionCount(){return this.get("metadata").getDefinition("questionCount")},isPassed:function isPassed(){var e=this.get("bestEvaluation");return e&&e.get("isPassed")},getMinimumPassingScore:function getMinimumPassingScore(){return Math.ceil(this.getPassingFraction()*this.getQuestionCount())},getLastSubmittedAttempt:function getLastSubmittedAttempt(){return this.get("lastSubmittedAttemptIndex")},getPassingFraction:function getPassingFraction(){return s.assessments.defaultPassingFraction},getDisplayPassingPercent:function getDisplayPassingPercent(){return Math.round(100*this.getPassingFraction())+"%"},getRelativePassingState:function getRelativePassingState(e){return this.isPassed()?t.passed:t.notPassed},getDisplayEvaluation:function getDisplayEvaluation(e){return this.get("bestEvaluation")}}),o=function loadAssessmentContent(e){return n(e.metadata).then(function(t){return new a(_(t).extend(e))})};module.exports=o});