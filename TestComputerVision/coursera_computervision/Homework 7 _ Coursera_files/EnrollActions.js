define("bundles/certificate-enroll/actions/EnrollActions",["require","exports","module","underscore","q","js/lib/coursera.store","bundles/adsTracking/lib","bundles/phoenix/template/models/userAuthorization","pages/open-course/common/constants","bundles/phoenix/template/models/userIdentity","bundles/group-enroll/utils/GroupMembershipAPIUtils","js/lib/alt","js/lib/coursera.redirect","pages/open-course/common/models/membership"],function(require,exports,module){"use strict";function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var l=function(){function defineProperties(n,t){for(var r=0;r<t.length;r++){var e=t[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,r,t){return r&&defineProperties(e.prototype,r),t&&defineProperties(e,t),e}}(),_=require("underscore"),t=require("q"),n=require("js/lib/coursera.store"),o=require("bundles/adsTracking/lib"),i=require("bundles/phoenix/template/models/userAuthorization"),u=require("pages/open-course/common/constants"),r=require("bundles/phoenix/template/models/userIdentity"),s=require("bundles/group-enroll/utils/GroupMembershipAPIUtils"),a=require("js/lib/alt"),c=require("js/lib/coursera.redirect"),d=require("pages/open-course/common/models/membership"),e=function enrollAction(e,a){var l=a||{redirectUrlAfterAuth:e.getLink()},c=l.redirectUrlAfterAuth,p=l.role;if(i.ensureAuthenticated({redirectUrl:c})){var f=new d({courseId:e.get("id")}),s=f.enroll(p);return s.then(function(){return n.set(u.onboardModalStorageKey+e.get("id"),!0),o.trackEnroll(r.get("id"))}).done(),s}return t.reject()},p=function(){function EnrollActions(){_classCallCheck(this,EnrollActions),this.generateActions("updateHasCertificate","updateHasFacilitated","updateEnrolled","updateShowModal","updateHideFreeOption","openModalWithRedirectUrlAfterAuth")}return l(EnrollActions,[{key:"enrollWithGroupPayment",value:function enrollWithGroupPayment(r,t){var n=r.get("id"),o=t.groupId;return e(r,t).then(function(){return s.enrollInCourse(n,o)})}},{key:"enrollWithoutCertificate",value:function enrollWithoutCertificate(n,r){var o=r||{},t=o.redirectUrlAfterEnroll;return e(n,r).then(function(){_(t).isEmpty()||c.setLocation(t)})}},{key:"enroll",value:function enroll(r,t){return e(r,t)}}]),EnrollActions}();module.exports=a.createActions(p)});