define("bundles/ondemand/components/endOfCourse/components/HeaderSummary",["require","exports","module","react-with-addons","react-router","classnames","js/lib/path","pages/open-course/common/models/course","bundles/ondemand/components/HonorsBanner","bundles/page/components/TrackedLink2","bundles/page/components/TrackedButton","bundles/enroll/components/EnrollModal","pages/open-course/common/models/tracks","bundles/ondemand/utils/url","vendor/cnpm/fluxible.v0-4/addons/connectToStores","pages/open-course/common/constants","js/lib/coursera.react-intl","i18n!nls/ondemand","css!./__styles__/HeaderSummary"],function(require,exports,module){"use strict";function _defaults(e,o){for(var a=Object.getOwnPropertyNames(o),t=0;t<a.length;t++){var r=a[t],n=Object.getOwnPropertyDescriptor(o,r);n&&n.configurable&&void 0===e[r]&&Object.defineProperty(e,r,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var n=function(){function defineProperties(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,t,r){return t&&defineProperties(e.prototype,t),r&&defineProperties(e,r),e}}(),o=function get(a,c,l){var r=!0;e:for(;r;){var t=a,s=c,i=l;r=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,s);if(void 0===e){var n=Object.getPrototypeOf(t);if(null===n)return void 0;a=n,c=s,l=i,r=!0,e=n=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(i)}},e=require("react-with-addons"),a=require("react-router"),s=a.Link,i=require("classnames"),c=require("js/lib/path"),l=require("pages/open-course/common/models/course"),u=require("bundles/ondemand/components/HonorsBanner"),r=require("bundles/page/components/TrackedLink2"),d=r.TrackedA,p=require("bundles/page/components/TrackedButton"),m=require("bundles/enroll/components/EnrollModal"),f=require("pages/open-course/common/models/tracks"),h=f.HONORS_TRACK,g=require("bundles/ondemand/utils/url"),y=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),b=require("pages/open-course/common/constants"),v=require("js/lib/coursera.react-intl"),P=v.FormattedHTMLMessage,t=require("i18n!nls/ondemand");require("css!./__styles__/HeaderSummary");var k=function(r){function HeaderSummary(){var e=this;_classCallCheck(this,HeaderSummary),o(Object.getPrototypeOf(HeaderSummary.prototype),"constructor",this).apply(this,arguments),this.state={showEnrollModal:!1},this.openEnrollModal=function(){e.setState({showEnrollModal:!0})},this.closeEnrollModal=function(){e.setState({showEnrollModal:!1})}}return _inherits(HeaderSummary,r),n(HeaderSummary,[{key:"getFinalGrade",value:function getFinalGrade(){return this.props.finalGrade?this.props.finalGrade:"--"}},{key:"getCertificatePurchaseUrl",value:function getCertificatePurchaseUrl(){return c.join("/certificate",b.courseSlug)}},{key:"renderCertificateMessage",value:function renderCertificateMessage(){if(this.props.certificateLink)return e.createElement("a",{href:this.props.certificateLink},t("Course Certificate"));if(this.props.currentlyOwnsCertificate){if(!this.props.hasPassedWithVerification&&this.props.hasPassedPendingVerification)return t("Some of your assignments are still being verified.\n        Please check back soon to receive your Course Certificate!");if(this.props.hasPassedWithVerification||this.props.hasPassedPendingVerification){var n=e.createElement("a",{href:"/accomplishments"},t("your accomplishments page"));return e.createElement(P,{message:t("You have passed this course! Check your email for a link to your certificate.\n                      If you don't receive your certificate within 24 hours, check {accomplishmentsPageLink} to make\n                      sure that your profile is complete."),accomplishmentsPageLink:n})}return e.createElement("div",null,e.createElement("div",null,t("To receive your certificate, you must resubmit\n            and pass unverified assignments with verification.")),e.createElement(s,{to:g.getAssignmentsUrl()},t("View Assignments")))}var r="";return r=this.props.s12nId?e.createElement(p,{onClick:this.openEnrollModal,className:"button-link",trackingName:"headerSummaryButton"},t("Unlock a certificate")):e.createElement(d,{href:this.getCertificatePurchaseUrl(),trackingName:"headerSummaryLink"},t("Unlock a certificate")),e.createElement("span",null,r,t(" to share your achievement with the world!"))}},{key:"render",value:function render(){var r=this.props,o=r.course,a=r.currentlyOwnsCertificate,s=r.certificateLink,n=a||s||o.isCertificatePurchaseEnabled(),c=i("grade-section","horizontal-box","align-items-right",{"with-right-border":n});return e.createElement("div",{className:"rc-HeaderSummary horizontal-box"},this.props.hasFinalGrade&&e.createElement("div",{className:c},e.createElement("div",{className:"body-1-text final-grade-text"},t("Final Grade")),e.createElement("div",{className:"vertical-box align-items-vertical-center"},e.createElement("div",{className:"horizontal-box"},e.createElement("div",{className:"headline-6-text grade"},this.getFinalGrade()),e.createElement("div",{className:"headline-1-text percent-symbol"},"%")),this.props.hasPassedHonorsTrack&&e.createElement(u,{className:"honors-margin"}))),n&&e.createElement("div",{className:"flex-1 cert-section horizontal-box"},e.createElement("div",{className:"cert-ribbon"}),e.createElement("div",{className:"flex-1 cert-message"},this.renderCertificateMessage())),this.state.showEnrollModal&&e.createElement(m,{s12nId:this.props.s12nId,showFreeOption:!1,onClose:this.closeEnrollModal}))}}],[{key:"propTypes",value:{course:e.PropTypes.instanceOf(l).isRequired,currentlyOwnsCertificate:e.PropTypes.bool.isRequired,hasPassedWithVerification:e.PropTypes.bool.isRequired,hasPassedPendingVerification:e.PropTypes.bool.isRequired,hasFinalGrade:e.PropTypes.bool,finalGrade:e.PropTypes.string,hasPassedHonorsTrack:e.PropTypes.bool,certificateLink:e.PropTypes.string,s12nId:e.PropTypes.string},enumerable:!0}]),HeaderSummary}(e.Component);module.exports=y(k,["CourseViewGradeStore","VerificationStore","CourseStore","CertificateStore","S12nStore"],function(t,i){var e=t.CourseViewGradeStore,r=t.VerificationStore,a=t.CourseStore,s=t.CertificateStore,n=t.S12nStore,o=r.getVerificationDisplay();return{course:a.getMetadata(),hasFinalGrade:e.isPassable(),finalGrade:e.getFinalPercentCourseGrade(),currentlyOwnsCertificate:r.currentlyOwnsCertificate(),hasPassedWithVerification:e.hasPassedCourseWithVerification(),hasPassedPendingVerification:e.hasPendingItem(o)&&e.allVerifiedPassedOrPending(o),hasPassedHonorsTrack:e.hasPassedTrack(h),certificateLink:s.getCertificateLink(),s12nId:n.getS12n()?n.getS12n().s12n.get("id"):null}})});