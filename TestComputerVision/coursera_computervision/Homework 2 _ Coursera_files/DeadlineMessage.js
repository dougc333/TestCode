define("bundles/ondemand/components/DeadlineMessage",["require","exports","module","react-bootstrap","classnames","moment","react-with-addons","underscore","bundles/iconfont/Icon","bundles/ondemand/components/CongratulationBanner","bundles/ondemand/components/CourseCompleteMessage","bundles/ondemand/components/DeadlinesResetButton","bundles/ondemand/components/enrollBox/SessionSwitchButton","bundles/page/components/TrackedDiv","js/lib/coursera.react-intl","js/lib/moment.validator","i18n!nls/ondemand","css!bundles/ondemand/components/__styles__/DeadlineMessage","bundles/ondemand/stores/SessionStore","bundles/ondemand/utils/onDemandSessionsApi","bundles/ondemand/constants/PeerReview"],function(require,exports,module){"use strict";function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),s=0;s<r.length;s++){var n=r[s],t=Object.getOwnPropertyDescriptor(o,n);t&&t.configurable&&void 0===e[n]&&Object.defineProperty(e,n,t)}return e}function _classCallCheck(e,s){if(!(e instanceof s))throw new TypeError("Cannot call a class as a function")}function _inherits(s,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);s.prototype=Object.create(e&&e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(s,e):_defaults(s,e))}var y=function(){function defineProperties(t,n){for(var s=0;s<n.length;s++){var e=n[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(e,s,n){return s&&defineProperties(e.prototype,s),n&&defineProperties(e,n),e}}(),w=function get(r,l,p){var n=!0;e:for(;n;){var s=r,i=l,a=p;n=!1,null===s&&(s=Function.prototype);var e=Object.getOwnPropertyDescriptor(s,i);if(void 0===e){var t=Object.getPrototypeOf(s);if(null===t)return void 0;r=t,l=i,p=a,n=!0,e=t=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(a)}},l=require("react-bootstrap"),m=l.OverlayTrigger,a=l.Tooltip,f=require("classnames"),i=require("moment"),e=require("react-with-addons"),_=require("underscore"),t=require("bundles/iconfont/Icon"),u=require("bundles/ondemand/components/CongratulationBanner"),P=require("bundles/ondemand/components/CourseCompleteMessage"),c=require("bundles/ondemand/components/DeadlinesResetButton"),h=require("bundles/ondemand/components/enrollBox/SessionSwitchButton"),g=require("bundles/page/components/TrackedDiv"),b=require("js/lib/coursera.react-intl"),o=b.FormattedHTMLMessage,p=require("js/lib/moment.validator"),s=require("i18n!nls/ondemand");require("css!bundles/ondemand/components/__styles__/DeadlineMessage");var r=require("bundles/ondemand/stores/SessionStore"),v=require("bundles/ondemand/utils/onDemandSessionsApi"),E=require("bundles/ondemand/constants/PeerReview"),T=E.PEER_REVIEW_SUGGEST_NEXT_SESSION_AFTER_DAYS,n=function(s){function MessageContainer(){_classCallCheck(this,MessageContainer),w(Object.getPrototypeOf(MessageContainer.prototype),"constructor",this).apply(this,arguments)}return _inherits(MessageContainer,s),y(MessageContainer,[{key:"render",value:function render(){return e.createElement(g,{className:f("rc-DeadlineMessage","od-section",this.props.className),trackingName:"instructor_message_quiz_reminder",data:{week:this.props.week}},e.createElement("div",{className:"horizontal-box align-items-vertical-center deadline-container"},this.props.children))}}],[{key:"propTypes",value:{week:e.PropTypes.number,className:e.PropTypes.string,children:e.PropTypes.node},enumerable:!0}]),MessageContainer}(e.Component),d=function areAllPeerAssessSubmitted(e){return!_(e).findWhere({submitted:!1})};exports.SessionDeadlineMessage=e.createClass({displayName:"SessionDeadlineMessage",propTypes:{date:e.PropTypes.string.isRequired,time:e.PropTypes.string.isRequired,timezone:e.PropTypes.string.isRequired,week:e.PropTypes.number.isRequired,peerReviewsInfo:e.PropTypes.array},render:function render(){var r=e.createElement(a,null,e.createElement("span",null,s("Complete each week's assignments by the deadline."))),t=s("You must submit this week's assignments by\n      <span class='od-text-bold'>{date}, {time} {timezone}</span>.");return this.props.peerReviewsInfo.length&&!d(this.props.peerReviewsInfo)&&(t=s("This week has assignments that will be reviewed by your peers. If you submit late,\n        you might not get a grade. The deadline is\n        <span class='od-text-bold'>{date}, {time} {timezone}</span>")),e.createElement(n,{week:this.props.week},e.createElement("span",{className:"flex-1"},e.createElement("span",{className:"od-text-bold"},s("Deadline:")," "),e.createElement(o,{message:t,date:this.props.date,time:this.props.time,timezone:this.props.timezone})),e.createElement(m,{placement:"left",overlay:r},e.createElement("i",{className:"cif-question-circle"})))}}),exports.SessionDeadlineOverdueMessage=e.createClass({displayName:"SessionDeadlineOverdueMessage",propTypes:{date:e.PropTypes.string.isRequired,time:e.PropTypes.string.isRequired,timezone:e.PropTypes.string.isRequired,week:e.PropTypes.number.isRequired,peerReviewsInfo:e.PropTypes.array,sessionEndDate:e.PropTypes.string.isRequired,sessionEndTime:e.PropTypes.string.isRequired},getInitialState:function getInitialState(){return this.getStateFromStores()},componentWillMount:function componentWillMount(){r.listen(this.onChange)},componentDidMount:function componentDidMount(){this.state.enrollableSession||v.getFollowingSession(r.getSessionId()).done()},componentWillUnmount:function componentWillUnmount(){r.unlisten(this.onChange)},onChange:function onChange(){this.setState(this.getStateFromStores())},getStateFromStores:function getStateFromStores(){return{enrollableSession:r.getEnrollableSession()}},render:function render(){var l=!1,p=e.createElement(a,null,e.createElement("span",null,s("\nYou can still pass an assignment after the deadline.\nYou may no longer submit assignments after the course ends."))),r=s("You can still pass! Remember, you need to pass these assignments\n      before the course ends on {sessionEndDate}, {sessionEndTime} {timezone}.");return this.props.peerReviewsInfo.length&&!d(this.props.peerReviewsInfo)&&(i.duration(i().diff(i(this.props.date))).asDays()>T?this.state.enrollableSession?(r=s("This week has assignments that require peer reviews,\n            but the class has continued to later weeks.\n            Switch sessions to submit before the new deadline and receive reviews from classmates.\n            Don't worry, your progress will be saved!"),l=!0):r=s("This week has assignments that require peer reviews,\n            but the class has continued to later weeks.\n            Please check back for an upcoming session of the course to continue\n            with the assignment and get grades on time."):r=s("This week has assignments that must be reviewed by peers.\n          Please submit as soon as possible or there may not be classmates who can review your work.")),e.createElement(n,{week:this.props.week},e.createElement(t,{name:"warning"}),e.createElement("span",{className:"flex-1"},e.createElement("span",{className:"od-text-bold"},s("Assignments Overdue:")," "),e.createElement(o,{message:r,sessionEndDate:this.props.sessionEndDate,sessionEndTime:this.props.sessionEndTime,timezone:this.props.timezone})),l&&e.createElement(h,null),!this.props.peerReviewsInfo.length&&e.createElement(m,{placement:"left",overlay:p},e.createElement("i",{className:"cif-question-circle"})))}}),exports.ReminderMessage=e.createClass({displayName:"ReminderMessage",propTypes:{date:p.isRequired,numberOfQuizzes:e.PropTypes.number.isRequired,time:p.isRequired,timezone:e.PropTypes.string.isRequired,week:e.PropTypes.number.isRequired},render:function render(){return e.createElement(n,{week:this.props.week},e.createElement(t,{name:"warning"}),e.createElement(o,{message:s("\n  Remember, your {numQuizzes, plural, =1 {assignment } other {assignments }}\n  {numQuizzes, plural, =1 {is} other {are}} <span class='od-text-bold'> due on {date} at {time} {timezone}.</span>"),numQuizzes:this.props.numberOfQuizzes,date:this.props.date,time:this.props.time,timezone:this.props.timezone}))}}),exports.OverdueMessage=e.createClass({displayName:"OverdueMessage",propTypes:{date:e.PropTypes.string.isRequired,time:e.PropTypes.string.isRequired,timezone:e.PropTypes.string.isRequired,week:e.PropTypes.number.isRequired},render:function render(){return e.createElement(n,{week:this.props.week},e.createElement(t,{name:"warning"}),e.createElement("span",{className:"flex-1"},e.createElement(o,{message:s("\n<span class='od-text-bold'>Assignments Overdue:&nbsp;</span>\nLooks like you're a bit behind schedule, but you can still get caught up!"),date:this.props.date,time:this.props.time,timezone:this.props.timezone})),e.createElement(c,null))}}),exports.CongratulationMessage=e.createClass({displayName:"CongratulationMessage",propTypes:{week:e.PropTypes.number,hasPassedCourse:e.PropTypes.bool.isRequired},render:function render(){return this.props.hasPassedCourse?e.createElement(n,null,e.createElement(t,{name:"info"}),e.createElement(P,{hasPassedCourse:this.props.hasPassedCourse})):e.createElement(n,{week:this.props.week},e.createElement(t,{name:"info"}),e.createElement(u,{week:this.props.week}))}})});