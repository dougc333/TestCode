define("bundles/ondemand/components/menu/FullMenuItems",["require","exports","module","q","react-with-addons","underscore","naptime","js/lib/mapProps","bundles/phoenix/template/models/userIdentity","bundles/course-references/components/CourseReferencesLink","bundles/course-references/components/CourseReferencesList","bundles/group-roster/components/GroupClassmatesPage","bundles/ondemand/components/CourseInfoPage","bundles/ondemand/components/menu/AdminButton","bundles/ondemand/components/menu/ForumSetList","bundles/ondemand/components/menu/MainNavItem","bundles/ondemand/components/menu/CourseManagerMenuItem","bundles/ondemand/components/menu/ModuleList","bundles/ondemand/utils/gle/inGleHomeExperiment","bundles/groups/models/Group","bundles/ondemand/constants/Constants","bundles/ondemand/utils/socialExperimentUtils","bundles/ondemand/utils/url","bundles/naptimejs/resources/onDemandPreviewingStates.v1","bundles/discussions/utils/ViewContextLoader","bundles/discussions/viewModels/viewContext","js/lib/getPropsFromPromise","js/lib/waitFor","pages/open-course/common/promises/courseAuthorization","bundles/naptimejs/resources/privilegedAuths.v1","i18n!nls/ondemand","vendor/cnpm/fluxible.v0-4/addons/connectToStores"],function(require,exports,module){"use strict";function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),t=0;t<r.length;t++){var s=r[t],n=Object.getOwnPropertyDescriptor(o,s);n&&n.configurable&&void 0===e[s]&&Object.defineProperty(e,s,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var h=function(){function defineProperties(n,s){for(var t=0;t<s.length;t++){var e=s[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,t,s){return t&&defineProperties(e.prototype,t),s&&defineProperties(e,s),e}}(),S=function get(r,a,u){var s=!0;e:for(;s;){var t=r,i=a,l=u;s=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,i);if(void 0===e){var n=Object.getPrototypeOf(t);if(null===n)return void 0;r=n,a=i,u=l,s=!0,e=n=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(l)}},y=require("q"),e=require("react-with-addons"),_=require("underscore"),j=require("naptime"),L=require("js/lib/mapProps"),i=require("bundles/phoenix/template/models/userIdentity"),u=require("bundles/course-references/components/CourseReferencesLink"),p=require("bundles/course-references/components/CourseReferencesList"),m=require("bundles/group-roster/components/GroupClassmatesPage"),d=require("bundles/ondemand/components/CourseInfoPage"),c=require("bundles/ondemand/components/menu/AdminButton"),v=require("bundles/ondemand/components/menu/ForumSetList"),s=require("bundles/ondemand/components/menu/MainNavItem"),b=require("bundles/ondemand/components/menu/CourseManagerMenuItem"),I=require("bundles/ondemand/components/menu/ModuleList"),f=require("bundles/ondemand/utils/gle/inGleHomeExperiment"),U=require("bundles/groups/models/Group"),E=require("bundles/ondemand/constants/Constants"),t=E.mainNavItems,g=require("bundles/ondemand/utils/socialExperimentUtils"),C=g.isForumsBlacklisted,o=require("bundles/ondemand/utils/url"),N=o.getDiscussionsUrl,O=o.getHomeUrl,P=o.getAssignmentsUrl,l=o.getOfficeHoursUrl,G=require("bundles/naptimejs/resources/onDemandPreviewingStates.v1"),w=require("bundles/discussions/utils/ViewContextLoader"),F=require("bundles/discussions/viewModels/viewContext"),M=require("js/lib/getPropsFromPromise"),T=require("js/lib/waitFor"),R=require("pages/open-course/common/promises/courseAuthorization"),k=require("bundles/naptimejs/resources/privilegedAuths.v1"),n=require("i18n!nls/ondemand"),x=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),a=d.getUrl,r=function(o){function FullMenuItems(){_classCallCheck(this,FullMenuItems),S(Object.getPrototypeOf(FullMenuItems.prototype),"constructor",this).apply(this,arguments),this.state={canTeach:!1}}return _inherits(FullMenuItems,o),h(FullMenuItems,[{key:"componentWillMount",value:function componentWillMount(){var e=this;R.then(function(t){e.setState({canTeach:t.canTeach})}).done()}},{key:"render",value:function render(){var h=this.props,o=h.groupContext,r=h.eventGroup,E=h.previewState,S=E&&!!E.previewBranchId,i=f(this.props.hasPaidForCourse),d=this.props.selectedItem===t.HOME;i&&(d=d||this.props.selectedItem===t.COURSE);var w=e.createElement(s,{name:t.HOME,title:n("Course Home"),link:O(),selected:d,isItemNav:this.props.isItemNav}),y=e.createElement(s,{name:t.ASSIGNMENTS,title:n(i?"Grades":"Assignments"),link:P(),selected:this.props.selectedItem===t.ASSIGNMENTS,isItemNav:this.props.isItemNav}),g=!C(),F=e.createElement(s,{name:t.DISCUSSIONS,title:n("Discussions"),link:o?o.get("discussionsLink"):N(),selected:this.props.selectedItem===t.DISCUSSIONS,isItemNav:this.props.isItemNav,locked:S}),M=e.createElement(s,{name:t.OFFICE_HOURS,title:n("Office Hours"),link:l(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),T=e.createElement(s,{name:t.OFFICE_HOURS,title:n("Live Events"),link:l(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),R=e.createElement(s,{name:t.COURSE,title:n("Course Content"),link:this.props.scheduleUrl,selected:this.props.selectedItem===t.COURSE,isItemNav:this.props.isItemNav}),x=e.createElement(s,{name:t.CLASSMATES,title:n("Classmates"),link:m.getUrl(),selected:this.props.selectedItem===t.CLASSMATES,isItemNav:this.props.isItemNav,locked:S}),j=e.createElement(s,{name:t.INFO,title:n("Course Info"),link:a(),selected:this.props.selectedItem===t.INFO,isItemNav:this.props.isItemNav}),U=!_(this.props.rosterGroups).isEmpty()||this.state.canTeach,G=!this.props.isItemNav&&(this.props.selectedItem===t.COURSE||i&&this.props.selectedItem===t.HOME);return e.createElement("ul",{className:"rc-FullMenuItems c-main-menu flex-1 vertical-box nostyle",onClick:this.props.hideMobileMenu},!this.props.isItemNav&&e.createElement(c,null),e.createElement("li",null,w),!i&&e.createElement("li",null,R),G&&e.createElement(I,null),this.props.hasGradableItems&&e.createElement("li",null,y),g&&e.createElement("li",null,F),g&&o&&!this.props.isItemNav&&this.props.selectedItem===t.DISCUSSIONS&&e.createElement(v,{groupContext:o}),r&&r.isFacilitatedGroup()&&e.createElement("li",null,M),r&&!r.isFacilitatedGroup()&&e.createElement("li",null,T),U&&e.createElement("li",null,x),e.createElement("li",null,e.createElement(u,{isSelected:this.props.selectedItem===t.REFERENCES,isItemNav:this.props.isItemNav})),!this.props.isItemNav&&this.props.selectedItem===t.REFERENCES&&e.createElement(p,null),e.createElement("li",null,j),e.createElement("li",null,e.createElement(b,{selected:this.props.selectedItem===t.COURSE_MANAGER,isItemNav:this.props.isItemNav})))}}],[{key:"propTypes",value:{hideMobileMenu:e.PropTypes.func.isRequired,scheduleUrl:e.PropTypes.string.isRequired,hasGradableItems:e.PropTypes.bool.isRequired,hasPaidForCourse:e.PropTypes.bool.isRequired,selectedItem:e.PropTypes.string,isItemNav:e.PropTypes.bool,rosterGroups:e.PropTypes.array,groupContext:e.PropTypes.instanceOf(F),eventGroup:e.PropTypes.instanceOf(U),previewState:e.PropTypes.object,isEnrolled:e.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{isItemNav:!1,showEvents:!1},enumerable:!0}]),FullMenuItems}(e.Component);module.exports=_.compose(x(["CourseStore","FacilitatedStore","GroupEntitlementStore","CourseMembershipStore","SessionStore","VerificationStore"],function(e,a){var s=e.CourseStore,n=e.FacilitatedStore,t=e.GroupEntitlementStore,o=e.CourseMembershipStore,r=e.SessionStore,l=e.VerificationStore;return{hasLoaded:s.hasLoaded()&&n.hasLoaded()&&t.hasGroupsLoaded(),hasGradableItems:s.hasGradableItems(),rosterGroups:t.getMyGroupsWithRosterEnabled(),eventGroups:t.getMyGroupsWithEventsEnabled(),forumGroups:t.getMyGroupsWithForumsEnabled(),isEnrolled:r.isEnrolled(),canPreviewBranches:o.hasTeachingRole()||i.get("is_superuser"),hasPaidForCourse:l.currentlyOwnsCertificate()}}),T(function(e){var t=e.hasLoaded;return t}),M(function(e){var t=e.eventGroups,s=e.forumGroups,n=s.length>0?s[0].id:null,o=t.length>0?t[0]:null,r=n?w.loadGroupContext(n):y(null);return r.then(function(e){return{groupContext:e,eventGroup:o}})}),j.createContainer(function(e){var t=e.courseId,s=e.canPreviewBranches,n=[i.get("id"),t].join("~");return{previewState:s&&G.get(n,{required:!1,fields:["previewBranchId"]})}}))(r),module.exports.BaseComp=r});