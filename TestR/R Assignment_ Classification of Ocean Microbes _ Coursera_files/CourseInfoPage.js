define("bundles/ondemand/components/CourseInfoPage",["require","exports","module","classnames","jquery","react-dom","react-with-addons","bundles/catalog/components/ShareCourseButtons","bundles/catalogP/models/s12n","bundles/certificate-enroll/components/FinaidLink","bundles/certificate/components/CertificatePromoBox","bundles/content-feedback/components/CourseRatingsPreviewBox","bundles/facilitated-cdp/components/FacilitatedCdpContent","bundles/facilitated-cdp/components/Header","bundles/facilitated-cdp/models/FacilitatedGroup","bundles/facilitated-cdp/models/FakeCourseData","bundles/facilitated-cdp/utils/FacilitatedLearningExperimentUtils","bundles/facilitated-cdp/utils/ScrollUtils","bundles/mobile/lib/mobileDeepLink","bundles/ondemand/components/AboutBox","bundles/ondemand/components/CourseInfoHeader","bundles/ondemand/components/HowToPass","bundles/ondemand/components/InstructorBox","bundles/ondemand/components/ReferrerInformation","bundles/ondemand/components/RelatedCourses","bundles/ondemand/components/Syllabus","bundles/ondemand/components/enrollBox/EnrollBox","bundles/ondemand/components/s12n/CapstoneStatusBanner","bundles/ondemand/components/s12n/S12nInfoBox","bundles/ondemand/components/sessions/ModeSwitcher","bundles/ondemand/models/S12n","bundles/ondemand/sessions/models/Schedule","bundles/ondemand/utils/premiumGradingExperimentUtils","bundles/pathways/components/common/HideIfEnrolledThroughPathway","bundles/payments/models/productPrice","bundles/phoenix-cdp/components/sections-subcomponents/PhoenixCdpMetatags","bundles/phoenix/lib/waitForStores","bundles/phoenix/template/models/userIdentity","bundles/phoenix/utils/matchMedia","bundles/recentlyViewed/lib","bundles/seo/components/CourseGoogleSchemaMarkup","js/app/retracked","js/lib/coursera.react-intl","i18n!nls/ondemand","pages/open-course/common/constants","pages/open-course/common/models/course","pages/open-course/common/models/courseMaterials","css!./__styles__/CourseInfoPage","js/lib/affix"],function(require,exports,module){"use strict";function _defaults(e,r){for(var s=Object.getOwnPropertyNames(r),t=0;t<s.length;t++){var n=s[t],o=Object.getOwnPropertyDescriptor(r,n);o&&o.configurable&&void 0===e[n]&&Object.defineProperty(e,n,o)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var M=Object.assign||function(o){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},n=function(){function defineProperties(o,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(o,e.key,e)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),a=function get(s,c,l){var n=!0;e:for(;n;){var t=s,a=c,i=l;n=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,a);if(void 0===e){var o=Object.getPrototypeOf(t);if(null===o)return void 0;s=o,c=a,l=i,n=!0,e=o=void 0;continue e}if("value"in e)return e.value;var r=e.get;if(void 0===r)return void 0;return r.call(i)}},i=require("classnames"),$=require("jquery"),G=require("react-dom"),e=require("react-with-addons"),R=require("bundles/catalog/components/ShareCourseButtons"),z=require("bundles/catalogP/models/s12n"),W=require("bundles/certificate-enroll/components/FinaidLink"),J=require("bundles/certificate/components/CertificatePromoBox"),Z=require("bundles/content-feedback/components/CourseRatingsPreviewBox"),p=require("bundles/facilitated-cdp/components/FacilitatedCdpContent"),m=require("bundles/facilitated-cdp/components/Header"),f=require("bundles/facilitated-cdp/models/FacilitatedGroup"),b=require("bundles/facilitated-cdp/models/FakeCourseData"),h=require("bundles/facilitated-cdp/utils/FacilitatedLearningExperimentUtils"),g=require("bundles/facilitated-cdp/utils/ScrollUtils"),y=require("bundles/mobile/lib/mobileDeepLink"),P=require("bundles/ondemand/components/AboutBox"),v=require("bundles/ondemand/components/CourseInfoHeader"),E=require("bundles/ondemand/components/HowToPass"),C=require("bundles/ondemand/components/InstructorBox"),S=require("bundles/ondemand/components/ReferrerInformation"),x=require("bundles/ondemand/components/RelatedCourses"),w=require("bundles/ondemand/components/Syllabus"),u=require("bundles/ondemand/components/enrollBox/EnrollBox"),O=require("bundles/ondemand/components/s12n/CapstoneStatusBanner"),T=require("bundles/ondemand/components/s12n/S12nInfoBox"),k=require("bundles/ondemand/components/sessions/ModeSwitcher"),I=require("bundles/ondemand/models/S12n"),F=require("bundles/ondemand/sessions/models/Schedule"),j=require("bundles/ondemand/utils/premiumGradingExperimentUtils"),t=require("bundles/pathways/components/common/HideIfEnrolledThroughPathway"),o=require("bundles/payments/models/productPrice"),q=require("bundles/phoenix-cdp/components/sections-subcomponents/PhoenixCdpMetatags"),B=require("bundles/phoenix/lib/waitForStores"),r=require("bundles/phoenix/template/models/userIdentity"),D=require("bundles/phoenix/utils/matchMedia"),L=D.isTabletOrSmaller,N=require("bundles/recentlyViewed/lib"),U=require("bundles/seo/components/CourseGoogleSchemaMarkup"),V=require("js/app/retracked"),H=require("js/lib/coursera.react-intl"),A=H.FormattedHTMLMessage,c=require("i18n!nls/ondemand"),l=require("pages/open-course/common/constants"),s=require("pages/open-course/common/models/course"),K=require("pages/open-course/common/models/courseMaterials");require("css!./__styles__/CourseInfoPage"),require("js/lib/affix");var Q=l.courseRootPath,X=l.vcLandingPagePath,Y=function(o){function NonFacilitatedContent(){_classCallCheck(this,NonFacilitatedContent),a(Object.getPrototypeOf(NonFacilitatedContent.prototype),"constructor",this).apply(this,arguments)}return _inherits(NonFacilitatedContent,o),n(NonFacilitatedContent,[{key:"render",value:function render(){var n=this.props,o=n.course,r=n.isPreEnrollEnabled;return e.createElement("div",{className:"rc-NonFacilitatedContent"},e.createElement("div",{className:"about-container card-no-action primary comfy"},e.createElement(P,null)),e.createElement(t,{courseId:o.get("id")},e.createElement(T,null)),e.createElement(C,null),!r&&e.createElement(w,null),e.createElement(E,null),e.createElement(x,null))}}],[{key:"propTypes",value:{isPreEnrollEnabled:e.PropTypes.bool.isRequired,course:e.PropTypes.instanceOf(s).isRequired},enumerable:!0}]),NonFacilitatedContent}(e.Component),d=function(l){function CourseInfoPage(e){var t=this;_classCallCheck(this,CourseInfoPage),a(Object.getPrototypeOf(CourseInfoPage.prototype),"constructor",this).call(this,e),this.onScroll=function(){if(!L()){var e=$(document).scrollTop(),n=$(document).height(),r=$(".cdp-header").height(),o=$(".right-rail-content").height(),s=r+23,a=n-o-81;s>=e?t.setState({top:!0,bottom:!1}):e>=a?(t.setState({top:!1,bottom:!0}),$(".right-rail-content").css("margin-top",n-o-146+"px")):(t.setState({top:!1,bottom:!1}),$(".right-rail-content").css("margin-top","auto"))}};var n=e.course,o=e.facilitatedGroups,r=e.catalogS12n,s=n.get("id");this.state={isFacilitated:h.isFacilitatedLearningEnabled(s,o),isPremiumGrading:!!j.showPremiumGrading(r),top:!0,bottom:!1}}return _inherits(CourseInfoPage,l),n(CourseInfoPage,null,[{key:"propTypes",value:{isPreEnrollEnabled:e.PropTypes.bool.isRequired,course:e.PropTypes.instanceOf(s).isRequired,courseMaterials:e.PropTypes.instanceOf(K).isRequired,schedule:e.PropTypes.instanceOf(F).isRequired,fakeCourseData:e.PropTypes.instanceOf(b),catalogS12n:e.PropTypes.instanceOf(z),facilitatedGroups:e.PropTypes.arrayOf(e.PropTypes.instanceOf(f)),coursePrice:e.PropTypes.instanceOf(o),facilitatedPrice:e.PropTypes.instanceOf(o),fullPrice:e.PropTypes.instanceOf(o),showVCPromo:e.PropTypes.bool.isRequired,currentlyOwnsCertificate:e.PropTypes.bool.isRequired,hasPassedCourse:e.PropTypes.bool.isRequired,s12n:e.PropTypes.instanceOf(I)},enumerable:!0},{key:"contextTypes",value:{router:e.PropTypes.object.isRequired},enumerable:!0},{key:"childContextTypes",value:{course:e.PropTypes.instanceOf(s).isRequired},enumerable:!0}]),n(CourseInfoPage,[{key:"getChildContext",value:function getChildContext(){return{course:this.props.course}}},{key:"componentDidMount",value:function componentDidMount(){var e=this.props.course,n=10;if(g.setupInternalLinks(G.findDOMNode(this),n),N.course.add({id:e.get("id")}),this.context.router.location.query.referrerId){var t={};t.referrer_id=this.context.router.location.query.referrerId,r.get("authenticated")&&(t.user_id=r.get("id"))}this.state.isFacilitated&&window.addEventListener("scroll",this.onScroll),y.attemptDeepLink("/learn/"+e.get("slug"))}},{key:"componentWillUnmount",value:function componentWillUnmount(){this.state.isFacilitated&&window.removeEventListener("scroll",this.onScroll)}},{key:"render",value:function render(){var o=this.state,n=o.isFacilitated,a=o.top,l=o.bottom,s=this.props.course,d=i("main-column-content","flex-1",{facilitated:n}),f=i("right-rail-content",{facilitated:n,top:a,bottom:l});return e.createElement("div",{className:"rc-CourseInfoPage"},n?e.createElement(m,null):e.createElement(v,null),e.createElement("div",{className:"content"},e.createElement(O,null),e.createElement("div",{className:"column-container horizontal-box wrap"},e.createElement("div",{className:d},n?e.createElement(p,{isPremiumGrading:this.state.isPremiumGrading,course:this.props.course,courseMaterials:this.props.courseMaterials,s12n:this.props.s12n,schedule:this.props.schedule,catalogS12n:this.props.catalogS12n,facilitatedGroups:this.props.facilitatedGroups,fakeCourseData:this.props.fakeCourseData,coursePrice:this.props.coursePrice,fullPrice:this.props.fullPrice}):e.createElement(Y,this.props)),e.createElement("div",{className:"right-rail"},e.createElement("div",{className:f},this.context.router.location.query.referrerId&&e.createElement(S,{referrerId:this.context.router.location.query.referrerId}),e.createElement(u,{facilitatedGroups:this.props.facilitatedGroups}),!this.props.currentlyOwnsCertificate&&this.props.course.isCertificatePurchaseEnabled()&&e.createElement(t,{courseId:s.get("id")},e.createElement(W,null,n&&e.createElement(A,{message:c('\n                            Financial Aid is available for learners who cannot afford the fee to purchase this course.\n                            <a href="#">Learn more and apply.</a>\n                          ')}))),e.createElement(k,null),this.props.showVCPromo&&e.createElement(t,{courseId:s.get("id")},e.createElement("div",{className:"cozy od-container card-rich-interaction"},e.createElement(J,{href:X}))),r.get("authenticated")&&e.createElement(Z,{course:this.props.course}),!n&&e.createElement("div",{className:"comfy od-container card-no-action primary"},e.createElement("h3",{className:"headline-2-text"},c("Share")),e.createElement(R,{courseId:this.props.course.get("id")})))))),e.createElement("div",null,e.createElement(U,{courseId:this.props.course.get("id")}),this.context.router.isActive({name:"CDP"})&&e.createElement(q,{courseId:this.props.course.get("id")})))}}],[{key:"getUrl",value:function getUrl(){return Q+"/home/info"}}]),CourseInfoPage}(e.Component),ee=V.createTrackedContainer(function(e){return{namespace:{page:"course_info"},course_id:e.course.id}})(d),te=B(ee,{requiredStores:["S12nStore","VerificationStore","FacilitatedStore"],lazyStores:["CourseStore","CourseScheduleStore","CourseViewGradeStore"]},function(e,a){var o=e.S12nStore,r=e.VerificationStore,n=e.CourseStore,i=e.CourseScheduleStore,t=e.FacilitatedStore,c=e.CourseViewGradeStore,s=n.getMetadata();return M({},a,{s12n:o.getS12n(),showVCPromo:!o.getS12n()&&s.isCertificatePurchaseEnabled()&&!!r.getVerificationPreferences(),isPreEnrollEnabled:n.isPreEnrollEnabledForUser(),currentlyOwnsCertificate:r.currentlyOwnsCertificate(),hasPassedCourse:c.hasPassedCourse(),course:s,courseMaterials:n.getMaterials(),schedule:i.getSchedule(),fakeCourseData:t.fakeCourseData,catalogS12n:t.catalogS12n,facilitatedGroups:t.facilitatedGroups,coursePrice:t.coursePrice,facilitatedPrice:t.facilitatedPrice,fullPrice:t.getFullPrice()})});module.exports=te,module.exports.getUrl=d.getUrl});