define("bundles/account-settings/stores/SettingsStore",["require","exports","module","underscore","../constants/SettingsConstants","../SettingsDispatcher","js/vendor/EventEmitter","js/models/user"],function(require,exports,module){"use strict";var _=require("underscore"),i=require("../constants/SettingsConstants"),h=require("../SettingsDispatcher"),N=i.Fields,t=i.Actions,I=i.UpdateStates,n=i.TwoFactorAuthenticationStatus,r=i.AccountDeletionModalStatus,F=require("js/vendor/EventEmitter"),m=require("js/models/user"),U="en_US",a=null,R=null,l=null,O=!1,d=null,T=null,S=null,u=null,L={},D={state:I.IDLE},C={},E=n.UNAVAILABLE,A=[],g=null,c=!1,s=r.DISABLING_CONFIRMING_PASSWORD,o=[],e=_.extend({},F.prototype,{getUser:function getUser(){return a},getUserId:function getUserId(){return a.get(N.ID)},getFullName:function getFullName(){return a.get(N.FULL_NAME)},getEmailAddress:function getEmailAddress(){return a.get(N.EMAIL_ADDRESS)},getLocale:function getLocale(){return a.get(N.LOCALE)||U},getTimezone:function getTimezone(){return a.get(N.TIMEZONE)},getUpdateStatus:function getUpdateStatus(){return D},getInvalidFields:function getInvalidFields(){return T},getUpdatedEmailAddress:function getUpdatedEmailAddress(){return S},getNotificationPreferences:function getNotificationPreferences(){return R},getCreditCardPreferences:function getCreditCardPreferences(){return l},getShowDeleteCreditCardModal:function getShowDeleteCreditCardModal(){return O},getEmailPreferences:function getEmailPreferences(){return d},getUnsubscribedAllEmails:function getUnsubscribedAllEmails(){return u},hasPendingChanges:function hasPendingChanges(){return!_(C).isEmpty()},getPartnerBannerStatus:function getPartnerBannerStatus(e){return L[e]},getTwoFactorAuthenticationStatus:function getTwoFactorAuthenticationStatus(){return E},getTwoFactorAuthenticationQRCode:function getTwoFactorAuthenticationQRCode(){return g},getTwoFactorAuthenticationInvalidFields:function getTwoFactorAuthenticationInvalidFields(){return A},isTwoFactorAuthenticationUpdating:function isTwoFactorAuthenticationUpdating(){return c},getShowDeleteAccountModal:function getShowDeleteAccountModal(){return s},getAccountDeletionInvalidFields:function getAccountDeletionInvalidFields(){return o}});e.dispatchToken=h.register(function(N){var i=N.action;switch(i.type){case t.HIDE_DELETE_CREDIT_CARD_MODAL:O=!1,e.emit("change");break;case t.SHOW_DELETE_CREDIT_CARD_MODAL:O=!0,e.emit("change");break;case t.RECEIVED_USER_SETTINGS:a=new m,a.login(i.userData),e.emit("change");break;case t.RECEIVED_CREDIT_CARD_PREFERENCES:l=i.creditCardPreferences,e.emit("change");break;case t.RECEIVED_EMAIL_PREFERENCES:d=i.emailPreferences,R=i.notificationPreferences,e.emit("change");break;case t.PARTNER_BANNER_STATUS_RECEIVED:L[i.partnerId]=i.status,e.emit("change");break;case t.RESET_SECTION:D={state:I.IDLE,section:i.section},T=[],S=null,u=null,e.emit("change");break;case t.UPDATE_STARTED:D={state:I.UPDATING,section:i.section},e.emit("change");break;case t.UPDATE_SUCCEEDED:i.data&&a.login(i.data),D={state:I.SUCCEEDED,section:i.section},T=[],delete C[i.section],e.emit("change");break;case t.UPDATE_FIELD_FAILED:T.push(i.field);break;case t.UPDATE_FAILED:D={state:I.FAILED,section:i.section},e.emit("change");break;case t.UPDATED_EMAIL_ADDRESS:S=i.email;break;case t.UNSUBSCRIBED_ALL_EMAILS:u=!0,e.emit("change");break;case t.UPDATE_PENDING_CHANGES_STATUS:C[i.section]=i.isChanged,e.emit("change");break;case t.LOADING_TWO_FACTOR_AUTHENTICATION_SETTINGS:E=n.LOADING,e.emit("change");break;case t.RECEIVED_TWO_FACTOR_AUTHENTICATION_SETTINGS:E=i.settings&&i.settings.details.enabled===!0?n.ENABLED:i.settings&&i.settings.details.enabled===!1?n.DISABLED:n.UNAVAILABLE,e.emit("change");break;case t.ENABLE_TWO_FACTOR_AUTHENTICATION:E=n.ENABLING_CONFIRMING_PASSWORD,e.emit("change");break;case t.RECEIVED_TWO_FACTOR_AUTHENTICATION_QR_CODE:g=i.qrCode,c=!1,E=n.ENABLING_CONFIRMING_CODE,e.emit("change");break;case t.RECEIVED_INVALID_PASSWORD:A=["password"],c=!1,e.emit("change");break;case t.RECEIVED_TWO_FACTOR_AUTHENTICATION_CODE_CONFIRMATION_RESPONSE:i.success?(g=null,c=!1,E=n.ENABLED):(A=["code"],c=!1),e.emit("change");break;case t.CANCEL_TWO_FACTOR_AUTHENTICATION_ACTION:E===n.ENABLING_CONFIRMING_PASSWORD||E===n.ENABLING_CONFIRMING_CODE?(E=n.DISABLED,e.emit("change")):E===n.DISABLING_CONFIRMING_PASSWORD&&(E=n.ENABLED),c=!1,A=[],e.emit("change");break;case t.PERFORMING_TWO_FACTOR_AUTHENTICATION_SERVER_ACTION:c=!0,A=[],e.emit("change");break;case t.DISABLE_TWO_FACTOR_AUTHENTICATION:E=n.DISABLING_CONFIRMING_PASSWORD,e.emit("change");break;case t.RECEIVED_SUCCESSFUL_DISABLING_TWO_FACTOR_AUTHENTICATION_RESPONSE:E=n.DISABLED,c=!1,e.emit("change");break;case t.DELETE_ACCOUNT:s=r.ENABLING_CONFIRMING_PASSWORD,e.emit("change");break;case t.CANCEL_ACCOUNT_DELETION_ACTION:s=r.DISABLING_CONFIRMING_PASSWORD,o=[],e.emit("change");break;case t.DELETE_ACCOUNT_DISABLED:s=r.DISABLED,o=[],e.emit("change");break;case t.RECEIVED_SUCCESSFUL_ACCOUNT_DELETION_RESPONSE:s=r.DISABLING_CONFIRMING_PASSWORD,e.emit("change");break;case t.RECEIVED_INVALID_ACCOUNT_DELETION_PASSWORD:o="password",e.emit("change")}}),module.exports=e});