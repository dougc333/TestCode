define("bundles/content-feedback/components/flag/FlagCategories",["require","exports","module","jquery","underscore","classnames","react-with-addons","react-dom","bundles/iconfont/Icon","react-bootstrap","bundles/content-feedback/constants/ItemFlagCategories","bundles/phoenix/mixins/DocumentClickMixin","i18n!nls/content-feedback","css!./__styles__/FlagCategories"],function(require,exports,module){"use strict";var $=require("jquery"),_=require("underscore"),n=require("classnames"),e=require("react-with-addons"),o=require("react-dom"),a=require("bundles/iconfont/Icon"),s=require("react-bootstrap"),l=s.Accordion,i=s.Panel,c=require("bundles/content-feedback/constants/ItemFlagCategories"),r=require("bundles/phoenix/mixins/DocumentClickMixin"),d=require("i18n!nls/content-feedback");require("css!./__styles__/FlagCategories");var t=e.createClass({displayName:"FlagCategories",mixins:[r],statics:{getCategoriesForType:function getCategoriesForType(e){return c[e]}},propTypes:{itemType:e.PropTypes.string.isRequired,comments:e.PropTypes.object.isRequired,onSend:e.PropTypes.func.isRequired,onRemove:e.PropTypes.func.isRequired,onCancel:e.PropTypes.func.isRequired,itemMetadata:e.PropTypes.object},getInitialState:function getInitialState(){var e=this.props.comments||{},a=t.getCategoriesForType(this.props.itemType),n=-1;return _(a).find(function(t,a){if(e[t.id])return n=a,!0}),{activeKey:n,comments:e}},componentDidMount:function componentDidMount(){this.addDocumentClickListener({elements:[o.findDOMNode(this)],onClick:this.handleClose})},handleSelect:function handleSelect(e){this.setState({activeKey:e})},handleCancel:function handleCancel(){this.setState({activeKey:-1})},handleRemove:function handleRemove(t){var e=$.extend(!0,this.state.comments,{});delete e[t.id],this.setState({comments:e}),this.props.onRemove(e)},handleSend:function handleSend(t,n){var e=$.extend(!0,this.state.comments,{});e[t.id]=n,this.setState({comments:e}),this.props.onSend(e)},handleClose:function handleClose(){this.setState({activeKey:-1}),this.props.onCancel()},renderPanelHeader:function renderPanelHeader(s,t){var o=t?"chevron-down":"chevron-right",i=n("c-flag-category-arrow",{down:t,right:!t}),c=n("c-flag-category-notification"),r=this.state.comments[s.id];return e.createElement("div",{className:"c-flag-category-header"},e.createElement(a,{className:i,name:o}),s.label,r&&e.createElement(a,{name:"circle",className:c}))},render:function render(){var n=this,a=t.getCategoriesForType(this.props.itemType);return e.createElement("div",{className:"rc-FlagCategories"},e.createElement(l,{activeKey:this.state.activeKey,onSelect:this.handleSelect},a.map(function(t,a){var s=n.state.activeKey==a,o=n.renderPanelHeader(t,s),c=t.Component;return e.createElement(i,{key:t.id,header:o,eventKey:a},e.createElement(c,{isFocused:s,categoryId:t.id,itemMetadata:n.props.itemMetadata,placeholder:d("e.g. "+t.example),initialCML:n.state.comments[t.id],onSend:function(e){return n.handleSend(t,e)},onRemove:function(e){return n.handleRemove(t)},onCancel:n.handleCancel}))})))}});module.exports=t});