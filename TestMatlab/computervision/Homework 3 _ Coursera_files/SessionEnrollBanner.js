define("bundles/ondemand/components/sessions/SessionEnrollBanner",["require","exports","module","classnames","react-with-addons","bundles/ondemand/components/enrollButton/EnrollButton","bundles/ondemand/components/sessions/SessionStartedModal","bundles/ondemand/models/S12n","bundles/payments/models/productPrice","bundles/facilitated-cdp/models/FacilitatedGroup","js/lib/coursera.react-intl","bundles/payments-common/components/ReactPriceDisplay","i18n!nls/ondemand","pages/open-course/common/constants","pages/open-course/common/models/itemMetadata","vendor/cnpm/fluxible.v0-4/addons/connectToStores","css!./__styles__/SessionEnrollBanner"],function(require,exports,module){"use strict";function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),n=0;n<r.length;n++){var s=r[n],t=Object.getOwnPropertyDescriptor(o,s);t&&t.configurable&&void 0===e[s]&&Object.defineProperty(e,s,t)}return e}function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function _inherits(n,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):_defaults(n,e))}var t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},d=function(){function defineProperties(t,s){for(var n=0;n<s.length;n++){var e=s[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}return function(e,n,s){return n&&defineProperties(e.prototype,n),s&&defineProperties(e,s),e}}(),m=function get(r,l,c){var s=!0;e:for(;s;){var n=r,a=l,i=c;s=!1,null===n&&(n=Function.prototype);var e=Object.getOwnPropertyDescriptor(n,a);if(void 0===e){var t=Object.getPrototypeOf(n);if(null===t)return void 0;r=t,l=a,c=i,s=!0,e=t=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(i)}},a=require("classnames"),e=require("react-with-addons"),i=require("bundles/ondemand/components/enrollButton/EnrollButton"),l=require("bundles/ondemand/components/sessions/SessionStartedModal"),c=require("bundles/ondemand/models/S12n"),g=require("bundles/payments/models/productPrice"),o=require("bundles/facilitated-cdp/models/FacilitatedGroup"),p=require("js/lib/coursera.react-intl"),r=p.FormattedMessage,u=require("bundles/payments-common/components/ReactPriceDisplay"),n=require("i18n!nls/ondemand"),f=require("pages/open-course/common/constants"),h=f.courseSlug,b=require("pages/open-course/common/models/itemMetadata"),y=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores");require("css!./__styles__/SessionEnrollBanner");var s=function(s){function SessionEnrollBanner(){_classCallCheck(this,SessionEnrollBanner),m(Object.getPrototypeOf(SessionEnrollBanner.prototype),"constructor",this).apply(this,arguments)}return _inherits(SessionEnrollBanner,s),d(SessionEnrollBanner,[{key:"getChildContext",value:function getChildContext(){return{facilitatedGroups:this.props.facilitatedGroups}}},{key:"render",value:function render(){if(this.props.isRestrictedCapstone||!this.props.isSessionAvailable)return null;var s={handleClose:this.handleClose,courseName:this.props.courseName,courseId:this.props.courseId,inItemPage:!0};if(this.props.hasSessionStarted&&this.props.isEnrolled)return e.createElement(l,t({justEnrolled:!0},s));var o=a("rc-SessionEnrollBanner",{"theme-dark":!this.props.isEnrolled,"theme-light":this.props.isEnrolled}),c=this.props.price?e.createElement(r,{message:n("Enroll â€” {coursePrice}"),coursePrice:e.createElement(u,{value:this.props.price.getDisplayAmount(),currency:this.props.price.getDisplayCurrencyCode()})}):void 0;return e.createElement("div",null,e.createElement("div",{className:o},e.createElement("div",{className:"content horizontal-box"},e.createElement("div",{className:"flex-1 align-self-center"},e.createElement("p",{ref:"enrollMessage",className:"color-primary-text headline-2-text"},e.createElement("span",{className:"upcoming-session-text"},n("Upcoming session: ")),e.createElement("span",null,this.props.sessionDates))),!this.props.isEnrolled&&e.createElement("p",{ref:"rightHandMessage",className:"enrollment-end color-secondary-text align-self-center"},e.createElement(r,{message:n("Enrollment ends {enrollmentEndDate}"),enrollmentEndDate:this.props.enrollmentEndDate})),e.createElement(i,{ref:"enrollButton",sessionId:this.props.sessionId,s12n:this.props.s12n,enrollText:c}))))}}],[{key:"propTypes",value:{courseName:e.PropTypes.string.isRequired,courseId:e.PropTypes.string.isRequired,itemMetadata:e.PropTypes.instanceOf(b).isRequired,hasS12nLoaded:e.PropTypes.bool.isRequired,price:e.PropTypes.instanceOf(g),isRestrictedCapstone:e.PropTypes.bool,s12n:e.PropTypes.instanceOf(c),facilitatedGroups:e.PropTypes.arrayOf(e.PropTypes.instanceOf(o)),sessionDates:e.PropTypes.any,sessionId:e.PropTypes.string,isEnrolled:e.PropTypes.bool,enrollmentEndDate:e.PropTypes.string,isSessionAvailable:e.PropTypes.bool,hasSessionStarted:e.PropTypes.bool},enumerable:!0},{key:"childContextTypes",value:{facilitatedGroups:e.PropTypes.arrayOf(e.PropTypes.instanceOf(o))},enumerable:!0}]),SessionEnrollBanner}(e.Component);module.exports=y(s,["S12nStore","FacilitatedStore","SessionStore"],function(s,r){var n=s.S12nStore,a=s.FacilitatedStore,e=s.SessionStore,i=r.courseId,o={hasS12nLoaded:n.hasLoaded(),isRestrictedCapstone:n.isRestrictedCapstone(),facilitatedGroups:a.facilitatedGroups,sessionDates:e.getSessionDates(),sessionId:e.getSessionId(),isEnrolled:e.isEnrolled(),enrollmentEndDate:e.getEnrollmentEndDate(),isSessionAvailable:e.isSessionAvailable(),hasSessionStarted:e.hasStarted()};if(n.getS12n()){var l=n.getS12n(),c=l.s12n,p=c.get("courses").get(i).get("price");return t({},o,{price:p})}return o}),module.exports.BaseComp=s});