define("bundles/ondemand/components/menu/FullMenuItems",["require","exports","module","q","react-with-addons","underscore","naptime","js/lib/mapProps","bundles/phoenix/template/models/userIdentity","bundles/course-references/components/CourseReferencesLink","bundles/course-references/components/CourseReferencesList","bundles/group-roster/components/GroupClassmatesPage","bundles/ondemand/components/CourseInfoPage","bundles/ondemand/components/menu/AdminButton","bundles/ondemand/components/menu/ForumSetList","bundles/ondemand/components/menu/MainNavItem","bundles/ondemand/components/menu/ModuleList","bundles/ondemand/utils/gle/inGleHomeExperiment","bundles/groups/models/Group","bundles/ondemand/constants/Constants","bundles/ondemand/utils/socialExperimentUtils","bundles/ondemand/utils/url","bundles/naptimejs/resources/onDemandPreviewingStates.v1","bundles/discussions/utils/ViewContextLoader","bundles/discussions/viewModels/viewContext","js/lib/getPropsFromPromise","js/lib/waitFor","pages/open-course/common/promises/courseAuthorization","bundles/naptimejs/resources/privilegedAuths.v1","i18n!nls/ondemand","vendor/cnpm/fluxible.v0-4/addons/connectToStores"],function(require,exports,module){"use strict";function _defaults(e,o){for(var r=Object.getOwnPropertyNames(o),t=0;t<r.length;t++){var s=r[t],n=Object.getOwnPropertyDescriptor(o,s);n&&n.configurable&&void 0===e[s]&&Object.defineProperty(e,s,n)}return e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):_defaults(t,e))}var b=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},E=function(){function defineProperties(n,s){for(var t=0;t<s.length;t++){var e=s[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,e.key,e)}}return function(e,t,s){return t&&defineProperties(e.prototype,t),s&&defineProperties(e,s),e}}(),y=function get(r,a,u){var s=!0;e:for(;s;){var t=r,i=a,l=u;s=!1,null===t&&(t=Function.prototype);var e=Object.getOwnPropertyDescriptor(t,i);if(void 0===e){var n=Object.getPrototypeOf(t);if(null===n)return void 0;r=n,a=i,u=l,s=!0,e=n=void 0;continue e}if("value"in e)return e.value;var o=e.get;if(void 0===o)return void 0;return o.call(l)}},M=require("q"),e=require("react-with-addons"),_=require("underscore"),a=require("naptime"),u=require("js/lib/mapProps"),i=require("bundles/phoenix/template/models/userIdentity"),p=require("bundles/course-references/components/CourseReferencesLink"),m=require("bundles/course-references/components/CourseReferencesList"),d=require("bundles/group-roster/components/GroupClassmatesPage"),c=require("bundles/ondemand/components/CourseInfoPage"),v=require("bundles/ondemand/components/menu/AdminButton"),h=require("bundles/ondemand/components/menu/ForumSetList"),n=require("bundles/ondemand/components/menu/MainNavItem"),f=require("bundles/ondemand/components/menu/ModuleList"),I=require("bundles/ondemand/utils/gle/inGleHomeExperiment"),g=require("bundles/groups/models/Group"),L=require("bundles/ondemand/constants/Constants"),t=L.mainNavItems,S=require("bundles/ondemand/utils/socialExperimentUtils"),C=S.isForumsBlacklisted,o=require("bundles/ondemand/utils/url"),O=o.getDiscussionsUrl,N=o.getHomeUrl,P=o.getAssignmentsUrl,l=o.getOfficeHoursUrl,w=o.getCourseManagerUrl,G=require("bundles/naptimejs/resources/onDemandPreviewingStates.v1"),R=require("bundles/discussions/utils/ViewContextLoader"),F=require("bundles/discussions/viewModels/viewContext"),T=require("js/lib/getPropsFromPromise"),j=require("js/lib/waitFor"),U=require("pages/open-course/common/promises/courseAuthorization"),x=require("bundles/naptimejs/resources/privilegedAuths.v1"),s=require("i18n!nls/ondemand"),A=require("vendor/cnpm/fluxible.v0-4/addons/connectToStores"),k=c.getUrl,r=function(o){function FullMenuItems(){_classCallCheck(this,FullMenuItems),y(Object.getPrototypeOf(FullMenuItems.prototype),"constructor",this).apply(this,arguments),this.state={canTeach:!1}}return _inherits(FullMenuItems,o),E(FullMenuItems,[{key:"componentWillMount",value:function componentWillMount(){var e=this;U.then(function(t){e.setState({canTeach:t.canTeach})}).done()}},{key:"render",value:function render(){var u=this.props,o=u.groupContext,r=u.eventGroup,b=u.previewState,g=b&&!!b.previewBranchId,i=I(),a=this.props.selectedItem===t.HOME;i&&(a=a||this.props.selectedItem===t.COURSE);var E=e.createElement(n,{name:t.HOME,title:s("Course Home"),link:N(),selected:a,isItemNav:this.props.isItemNav}),S=e.createElement(n,{name:t.ASSIGNMENTS,title:s(i?"Grades":"Assignments"),link:P(),selected:this.props.selectedItem===t.ASSIGNMENTS,isItemNav:this.props.isItemNav}),c=!C(),M=e.createElement(n,{name:t.DISCUSSIONS,title:s("Discussions"),link:o?o.get("discussionsLink"):O(),selected:this.props.selectedItem===t.DISCUSSIONS,isItemNav:this.props.isItemNav,locked:g}),G=e.createElement(n,{name:t.OFFICE_HOURS,title:s("Office Hours"),link:l(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),R=e.createElement(n,{name:t.OFFICE_HOURS,title:s("Live Events"),link:l(),selected:this.props.selectedItem===t.OFFICE_HOURS,isItemNav:this.props.isItemNav}),F=e.createElement(n,{name:t.COURSE,title:s("Course Content"),link:this.props.scheduleUrl,selected:this.props.selectedItem===t.COURSE,isItemNav:this.props.isItemNav}),T=e.createElement(n,{name:t.CLASSMATES,title:s("Classmates"),link:d.getUrl(),selected:this.props.selectedItem===t.CLASSMATES,isItemNav:this.props.isItemNav,locked:g}),j=e.createElement(n,{name:t.INFO,title:s("Course Info"),link:k(),selected:this.props.selectedItem===t.INFO,isItemNav:this.props.isItemNav}),U=e.createElement(n,{name:t.COURSE_MANAGER,title:s("Course Manager"),link:w(),selected:this.props.selectedItem===t.COURSE_MANAGER,isItemNav:this.props.isItemNav,subtitle:s("Staff & Mentors Only")}),x=!_(this.props.rosterGroups).isEmpty()||this.state.canTeach,y=!this.props.isItemNav&&(this.props.selectedItem===t.COURSE||i&&this.props.selectedItem===t.HOME);return e.createElement("ul",{className:"rc-FullMenuItems c-main-menu flex-1 vertical-box nostyle",onClick:this.props.hideMobileMenu},!this.props.isItemNav&&e.createElement(v,null),e.createElement("li",null,E),!i&&e.createElement("li",null,F),y&&e.createElement(f,null),this.props.hasGradableItems&&e.createElement("li",null,S),c&&e.createElement("li",null,M),c&&o&&!this.props.isItemNav&&this.props.selectedItem===t.DISCUSSIONS&&e.createElement(h,{groupContext:o}),r&&r.isFacilitatedGroup()&&e.createElement("li",null,G),r&&!r.isFacilitatedGroup()&&e.createElement("li",null,R),x&&e.createElement("li",null,T),e.createElement("li",null,e.createElement(p,{isSelected:this.props.selectedItem===t.REFERENCES,isItemNav:this.props.isItemNav})),!this.props.isItemNav&&this.props.selectedItem===t.REFERENCES&&e.createElement(m,null),e.createElement("li",null,j),this.props.showCourseManager&&e.createElement("li",null,U))}}],[{key:"propTypes",value:{hideMobileMenu:e.PropTypes.func.isRequired,scheduleUrl:e.PropTypes.string.isRequired,hasGradableItems:e.PropTypes.bool.isRequired,selectedItem:e.PropTypes.string,isItemNav:e.PropTypes.bool,rosterGroups:e.PropTypes.array,groupContext:e.PropTypes.instanceOf(F),eventGroup:e.PropTypes.instanceOf(g),previewState:e.PropTypes.object,isEnrolled:e.PropTypes.bool,showCourseManager:e.PropTypes.bool},enumerable:!0},{key:"defaultProps",value:{isItemNav:!1,showEvents:!1},enumerable:!0}]),FullMenuItems}(e.Component);module.exports=_.compose(A(["CourseStore","FacilitatedStore","GroupEntitlementStore","CourseMembershipStore","SessionStore"],function(e,l){var s=e.CourseStore,o=e.FacilitatedStore,t=e.GroupEntitlementStore,n=e.CourseMembershipStore,r=e.SessionStore;return{hasLoaded:s.hasLoaded()&&o.hasLoaded()&&t.hasGroupsLoaded(),hasGradableItems:s.hasGradableItems(),rosterGroups:t.getMyGroupsWithRosterEnabled(),eventGroups:t.getMyGroupsWithEventsEnabled(),forumGroups:t.getMyGroupsWithForumsEnabled(),isEnrolled:r.isEnrolled(),canPreviewBranches:n.hasTeachingRole()||i.get("is_superuser"),hasModerationRole:n.hasModerationRole(),hasPeerReviewItems:s.getMaterials().getPeerReviewItemMetadatas().length>0}}),j(function(e){var t=e.hasLoaded;return t}),T(function(e){var t=e.eventGroups,s=e.forumGroups,n=s.length>0?s[0].id:null,o=t.length>0?t[0]:null,r=n?R.loadGroupContext(n):M(null);return r.then(function(e){return{groupContext:e,eventGroup:o}})}),a.createContainer(function(e){var t=e.courseId,s=e.canPreviewBranches,n=[i.get("id"),t].join("~");return{previewState:s&&G.get(n,{required:!1,fields:["previewBranchId"]}),privilegedAuths:x.finder("me",{fields:["outsourcingPermissions"],required:!1})}}),u(function(e){return b({},e,{showCourseManager:e.hasPeerReviewItems&&(e.hasModerationRole||e.privilegedAuths&&e.privilegedAuths[0]&&!!e.privilegedAuths[0].outsourcingPermissions)})}))(r),module.exports.BaseComp=r});